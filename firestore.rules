service cloud.firestore {
  match /databases/{database}/documents {
  
      
      

      
    match /{document=**} {
      // allow read, write;
      
    	allow read, write: if request.auth.uid != null;
    }
    
    match /pool {
    	allow read, write;
    }
    
    match /posts/testPost {    
    function getRole(role){
   		return get(/databases/$(database)/documents/users/$(request.auth.uid)).data.roles[role]
    	}
          allow read: if getRole('subscriber') == true;
          allow update: if getRole('editor') == true;
          allow create, delete: if getRole('admin') == true;
    }
    
    match /new_posts/testPost {
    function getRole(role){
   		return get(/databases/$(database)/documents/users/$(request.auth.uid)).data.roles[role]
    	}
          allow read: if getRole('contractor') == true;
          allow update: if getRole('company_manager') == true;
          allow create, delete: if getRole('company_admin') == true;
          allow create, delete: if getRole('admin') == true;
    }
  }
}